<link rel="stylesheet" href="{{root}}/css/style.css">
<div id="chat" class='d-flex flex-column'>
    <div id="chatContent" class="d-flex flex-column py-auto">
    </div>
    <div id="inputBox" class="input-group">
        <input type="text" id="userInput" class="form-control">
        <button class="input-group-text btn btn-primary" onclick="sendMessage('{{endpoint}}', '{{context}}' {{ context == 'helpdesk' ? '' : ',' ~ ticket_id}})">
            <i class="fas fa-paper-plane"></i>
        </button>
        {% if context != 'helpdesk' %}
            <button
                class="input-group-text btn btn-warning"
                onclick="
                updateTicketWithPrompt('{{context}}', {{ticket_id}}, '{{endpoint}}')
                ">
                {{"Send"|trans ~ " " ~ context}}
            </button>
        {% endif %}
    </div>
</div>
<script src="{{root}}/js/scripts.js"></script>
<script>
context = []
{# function sendMessage(mode, ajax_endpoint, context, prompt, endpoint = '', model = '', displayUser = true) { #}
sendMessage('{{connection_type}}', '{{ajax_endpoint}}', context, `{{"Bonjour"|trans}}`, '{{endpoint|default("")}}', '{{model|default("")}}', false)
    .then(newContext => { context = newContext;
});
$('#userInput').on("keyup", function (event) {
    if (event.key === "Enter") {
        sendMessage('{{connection_type}}', '{{ajax_endpoint}}', context, $('#userInput').val(), '{{endpoint|default("")}}', '{{model|default("")}}', true)
        .then(newContext => { context = newContext; 
        });
    }
});
</script>